<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="L. Murray &amp; J. Wilson" />

<meta name="date" content="2020-09-08" />

<title>Introduction</title>

<script>// Hide empty <a> tag within highlighted CodeBlock for screen reader accessibility (see https://github.com/jgm/pandoc/issues/6352#issuecomment-626106786) -->
// v0.0.1
// Written by JooYoung Seo (jooyoung@psu.edu) and Atsushi Yasumoto on June 1st, 2020.

document.addEventListener('DOMContentLoaded', function() {
  const codeList = document.getElementsByClassName("sourceCode");
  for (var i = 0; i < codeList.length; i++) {
    var linkList = codeList[i].getElementsByTagName('a');
    for (var j = 0; j < linkList.length; j++) {
      if (linkList[j].innerHTML === "") {
        linkList[j].setAttribute('aria-hidden', 'true');
      }
    }
  }
});
</script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Introduction</h1>
<h4 class="author">L. Murray &amp; J. Wilson</h4>
<h4 class="date">2020-09-08</h4>



<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw">library</span>(<span class="st">&#39;genset&#39;</span>)</span></code></pre></div>
<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>This package was developed for educational purposes to demonstrate the importance of multiple regression. <code>genset</code> generates a data set from an initial data set to have the same summary statistics (mean, median, and standard deviation) but opposing regression results. The initial data set will have one response variable (continuous) and two predictor variables (continous or one continuous and one categorical with 2 levels) that are statistically significant in a linear regression model such as <span class="math inline">\(Y = X\beta + \epsilon\)</span>.</p>
</div>
<div id="functions" class="section level2">
<h2>Functions</h2>
<p>Use the following function if your data set consist of 2 predictor variables (both continuous):</p>
<p><code>genset(y=y, x1=x1, x2=x2, method=1, option=&quot;x1&quot;, n=n)</code></p>
<p>Use the following function if your data set consist of 2 predictor variables (1 continuous and 1 categorical with 2 levels):</p>
<p><code>genset(y=y, x1=x1, x2=factor(x2), method=1, option=&quot;x1&quot;, n=n)</code></p>
</div>
<div id="arguments" class="section level2">
<h2>Arguments</h2>
<ul>
<li><code>y</code> a vector containing the response variable (continuous).</li>
<li><code>x1</code> a vector containing the first predictor variable (continuous).</li>
<li><code>x2</code> a vector containing the second predictor variable (continuous or categorical with 2 levels). If variable is categorical then argument is <code>factor(x2)</code>.</li>
<li>method the method <code>1</code> or <code>2</code> to be used to generate the data set. <code>1</code> (default) rearranges the values within each variable, and <code>2</code> is a perturbation method that makes subtle changes to the values of the variables.</li>
<li>option the variable(s) that will not statistically significant in the new data set (<code>&quot;x1&quot;</code>, <code>&quot;x2&quot;</code> or - <code>&quot;both&quot;</code>).</li>
<li><code>n</code> the number of iterations.</li>
</ul>
</div>
<div id="details" class="section level2">
<h2>Details</h2>
<p>The summary statistics are within a (predetermined) tolerance level, and when rounded will be the same as the original data set. We use the standard convention 0.05 as the significance level. The default for the number of iterations is <code>n=2000</code>. Less than <code>n=2000</code> may or may not be sufficient and is dependent on the initial data set.</p>
</div>
<div id="value" class="section level2">
<h2>Value</h2>
<p>Returns an object of class “data.frame” containing the generated data set: (in order) the response variable, first predictor variable and second predictor variable.</p>
</div>
<div id="example-1-two-continuous-predictor-variables" class="section level2">
<h2>Example 1: Two Continuous Predictor Variables</h2>
<p>Load the <code>genset</code> library:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="kw">library</span>(<span class="st">&#39;genset&#39;</span>)</span></code></pre></div>
<p>We will use the built-in data set <code>mtcars</code> to illustrate how to generate a new data set. Details about the data set can be found by typing <code>?mtcars</code>. We set the variable <code>mpg</code> as the response variable <code>y</code>, and <code>hp</code> and <code>wt</code> as the two continous predictor variables (<code>x1</code> and <code>x2</code>). Then we combine the variables into a data frame called <code>set1</code>.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>y &lt;-<span class="st"> </span>mtcars<span class="op">$</span>mpg</span>
<span id="cb3-2"><a href="#cb3-2"></a>x1 &lt;-<span class="st"> </span>mtcars<span class="op">$</span>hp</span>
<span id="cb3-3"><a href="#cb3-3"></a>x2 &lt;-<span class="st"> </span>mtcars<span class="op">$</span>wt</span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>set1 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(y, x1, x2)</span></code></pre></div>
<p>We check the summary statistics (mean, median, and standard deviation) for the response variable and two predictor variables using the <code>round()</code> function. We round the statistics to the first significant digit of that variable. The <code>multi.fun()</code> is created for the convenience.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>multi.fun &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</span>
<span id="cb5-2"><a href="#cb5-2"></a>  <span class="kw">c</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(x), <span class="dt">media=</span><span class="kw">median</span>(x), <span class="dt">sd=</span><span class="kw">sd</span>(x))</span>
<span id="cb5-3"><a href="#cb5-3"></a>}</span>
<span id="cb5-4"><a href="#cb5-4"></a><span class="kw">round</span>(<span class="kw">multi.fun</span>(set1<span class="op">$</span>y), <span class="dv">1</span>)</span>
<span id="cb5-5"><a href="#cb5-5"></a><span class="co">#&gt;  mean media    sd </span></span>
<span id="cb5-6"><a href="#cb5-6"></a><span class="co">#&gt;  20.1  19.2   6.0</span></span>
<span id="cb5-7"><a href="#cb5-7"></a><span class="kw">round</span>(<span class="kw">multi.fun</span>(set1<span class="op">$</span>x1), <span class="dv">0</span>)</span>
<span id="cb5-8"><a href="#cb5-8"></a><span class="co">#&gt;  mean media    sd </span></span>
<span id="cb5-9"><a href="#cb5-9"></a><span class="co">#&gt;   147   123    69</span></span>
<span id="cb5-10"><a href="#cb5-10"></a><span class="kw">round</span>(<span class="kw">multi.fun</span>(set1<span class="op">$</span>x2), <span class="dv">3</span>)</span>
<span id="cb5-11"><a href="#cb5-11"></a><span class="co">#&gt;  mean media    sd </span></span>
<span id="cb5-12"><a href="#cb5-12"></a><span class="co">#&gt; 3.217 3.325 0.978</span></span></code></pre></div>
<p>We fit a linear model to the data set using the function <code>lm()</code> and check to see that both predictor variables are statistically significant (p-value &lt; 0.05).</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="kw">summary</span>(<span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x1, x2, <span class="dt">data=</span>set1))</span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="co">#&gt; </span></span>
<span id="cb6-3"><a href="#cb6-3"></a><span class="co">#&gt; Call:</span></span>
<span id="cb6-4"><a href="#cb6-4"></a><span class="co">#&gt; lm(formula = y ~ x1, data = set1, subset = x2)</span></span>
<span id="cb6-5"><a href="#cb6-5"></a><span class="co">#&gt; </span></span>
<span id="cb6-6"><a href="#cb6-6"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb6-7"><a href="#cb6-7"></a><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span id="cb6-8"><a href="#cb6-8"></a><span class="co">#&gt; -0.5725 -0.5725  0.3489  0.3489  0.4867 </span></span>
<span id="cb6-9"><a href="#cb6-9"></a><span class="co">#&gt; </span></span>
<span id="cb6-10"><a href="#cb6-10"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb6-11"><a href="#cb6-11"></a><span class="co">#&gt;              Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb6-12"><a href="#cb6-12"></a><span class="co">#&gt; (Intercept) 27.257343   0.395224   68.97  &lt; 2e-16 ***</span></span>
<span id="cb6-13"><a href="#cb6-13"></a><span class="co">#&gt; x1          -0.051680   0.003591  -14.39 5.25e-15 ***</span></span>
<span id="cb6-14"><a href="#cb6-14"></a><span class="co">#&gt; ---</span></span>
<span id="cb6-15"><a href="#cb6-15"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb6-16"><a href="#cb6-16"></a><span class="co">#&gt; </span></span>
<span id="cb6-17"><a href="#cb6-17"></a><span class="co">#&gt; Residual standard error: 0.4698 on 30 degrees of freedom</span></span>
<span id="cb6-18"><a href="#cb6-18"></a><span class="co">#&gt; Multiple R-squared:  0.8735, Adjusted R-squared:  0.8692 </span></span>
<span id="cb6-19"><a href="#cb6-19"></a><span class="co">#&gt; F-statistic: 207.1 on 1 and 30 DF,  p-value: 5.253e-15</span></span></code></pre></div>
<p>We set the function arguments of <code>genset()</code> to generate a new data set (<code>set2</code>) that will make the first predictor variable <code>hp</code>, no longer statistically significant using method <code>2</code>. We will use the function <code>set.seed()</code> so that the data set can be reproduced.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="kw">set.seed</span>(<span class="dv">101</span>)</span>
<span id="cb7-2"><a href="#cb7-2"></a>set2 &lt;-<span class="st"> </span><span class="kw">genset</span>(y, x1, x2, <span class="dt">method=</span><span class="dv">1</span>, <span class="dt">option=</span><span class="st">&quot;x1&quot;</span>)</span></code></pre></div>
<p>Check that the summary statisticis for Set 2 are the same as Set 1 above.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="kw">round</span>(<span class="kw">multi.fun</span>(set2<span class="op">$</span>y), <span class="dv">1</span>)</span>
<span id="cb8-2"><a href="#cb8-2"></a><span class="co">#&gt;  mean media    sd </span></span>
<span id="cb8-3"><a href="#cb8-3"></a><span class="co">#&gt;  20.1  19.2   6.0</span></span>
<span id="cb8-4"><a href="#cb8-4"></a><span class="kw">round</span>(<span class="kw">multi.fun</span>(set2<span class="op">$</span>x1), <span class="dv">0</span>)</span>
<span id="cb8-5"><a href="#cb8-5"></a><span class="co">#&gt;  mean media    sd </span></span>
<span id="cb8-6"><a href="#cb8-6"></a><span class="co">#&gt;   147   123    69</span></span>
<span id="cb8-7"><a href="#cb8-7"></a><span class="kw">round</span>(<span class="kw">multi.fun</span>(set2<span class="op">$</span>x2), <span class="dv">3</span>)</span>
<span id="cb8-8"><a href="#cb8-8"></a><span class="co">#&gt;  mean media    sd </span></span>
<span id="cb8-9"><a href="#cb8-9"></a><span class="co">#&gt; 3.217 3.325 0.978</span></span></code></pre></div>
<p>Fit a linear model to Set 2 and check to see that the first predictor variable <code>hp</code> is no longer statistically significant.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="kw">summary</span>(<span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x1 <span class="op">+</span><span class="st"> </span>x2, <span class="dt">data=</span>set2))</span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="co">#&gt; </span></span>
<span id="cb9-3"><a href="#cb9-3"></a><span class="co">#&gt; Call:</span></span>
<span id="cb9-4"><a href="#cb9-4"></a><span class="co">#&gt; lm(formula = y ~ x1 + x2, data = set2)</span></span>
<span id="cb9-5"><a href="#cb9-5"></a><span class="co">#&gt; </span></span>
<span id="cb9-6"><a href="#cb9-6"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb9-7"><a href="#cb9-7"></a><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span id="cb9-8"><a href="#cb9-8"></a><span class="co">#&gt; -9.0219 -4.0385 -0.2858  3.8869 11.7938 </span></span>
<span id="cb9-9"><a href="#cb9-9"></a><span class="co">#&gt; </span></span>
<span id="cb9-10"><a href="#cb9-10"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb9-11"><a href="#cb9-11"></a><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb9-12"><a href="#cb9-12"></a><span class="co">#&gt; (Intercept) 14.34968    3.75108   3.825 0.000641 ***</span></span>
<span id="cb9-13"><a href="#cb9-13"></a><span class="co">#&gt; x1          -0.01931    0.01499  -1.289 0.207666    </span></span>
<span id="cb9-14"><a href="#cb9-14"></a><span class="co">#&gt; x2           2.66500    1.05010   2.538 0.016785 *  </span></span>
<span id="cb9-15"><a href="#cb9-15"></a><span class="co">#&gt; ---</span></span>
<span id="cb9-16"><a href="#cb9-16"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb9-17"><a href="#cb9-17"></a><span class="co">#&gt; </span></span>
<span id="cb9-18"><a href="#cb9-18"></a><span class="co">#&gt; Residual standard error: 5.59 on 29 degrees of freedom</span></span>
<span id="cb9-19"><a href="#cb9-19"></a><span class="co">#&gt; Multiple R-squared:  0.1951, Adjusted R-squared:  0.1396 </span></span>
<span id="cb9-20"><a href="#cb9-20"></a><span class="co">#&gt; F-statistic: 3.515 on 2 and 29 DF,  p-value: 0.04297</span></span></code></pre></div>
</div>
<div id="example-2-two-predictor-variables-1-continuous-1-categorical" class="section level2">
<h2>Example 2: Two Predictor Variables (1 Continuous, 1 Categorical)</h2>
<p>This time we will use a categorical predictor variable engine <code>vs</code> where <code>0</code> is V-shaped and <code>1</code> is straight. We will use the same response variable <code>mpg</code> and predictor variable <code>wt</code> making the categorical or factor variable is assigned to <code>x2</code>. Combine the three variables in a data frame called <code>set3</code>.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>y &lt;-<span class="st"> </span>mtcars<span class="op">$</span>mpg</span>
<span id="cb10-2"><a href="#cb10-2"></a>x1 &lt;-<span class="st"> </span>mtcars<span class="op">$</span>wt</span>
<span id="cb10-3"><a href="#cb10-3"></a>x2 &lt;-<span class="st"> </span>mtcars<span class="op">$</span>vs</span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>set3 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(y, x1, x2)</span></code></pre></div>
<p>Since we have a categorical predictor variable, we need to subset the data. Then we can check the summary statistics (mean, median, and standard deviation) for the response variable and predictor variable in terms of the categorical variable (ie. the marginal distributions for <code>vs</code>) We round the statistics to the first significant digit of that variable.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>v.shape &lt;-<span class="st"> </span><span class="kw">subset</span>(set3, x2<span class="op">==</span><span class="dv">0</span>)</span>
<span id="cb12-2"><a href="#cb12-2"></a>straight &lt;-<span class="st"> </span><span class="kw">subset</span>(set3, x2<span class="op">==</span><span class="dv">1</span>) </span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>multi.fun &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</span>
<span id="cb13-2"><a href="#cb13-2"></a>  <span class="kw">c</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(x), <span class="dt">media=</span><span class="kw">median</span>(x), <span class="dt">sd=</span><span class="kw">sd</span>(x))</span>
<span id="cb13-3"><a href="#cb13-3"></a>}</span>
<span id="cb13-4"><a href="#cb13-4"></a><span class="kw">round</span>(<span class="kw">multi.fun</span>(v.shape<span class="op">$</span>y), <span class="dv">1</span>)</span>
<span id="cb13-5"><a href="#cb13-5"></a><span class="co">#&gt;  mean media    sd </span></span>
<span id="cb13-6"><a href="#cb13-6"></a><span class="co">#&gt;  16.6  15.7   3.9</span></span>
<span id="cb13-7"><a href="#cb13-7"></a><span class="kw">round</span>(<span class="kw">multi.fun</span>(v.shape<span class="op">$</span>x1), <span class="dv">3</span>)</span>
<span id="cb13-8"><a href="#cb13-8"></a><span class="co">#&gt;  mean media    sd </span></span>
<span id="cb13-9"><a href="#cb13-9"></a><span class="co">#&gt; 3.689 3.570 0.904</span></span>
<span id="cb13-10"><a href="#cb13-10"></a><span class="kw">round</span>(<span class="kw">multi.fun</span>(straight<span class="op">$</span>y), <span class="dv">1</span>)</span>
<span id="cb13-11"><a href="#cb13-11"></a><span class="co">#&gt;  mean media    sd </span></span>
<span id="cb13-12"><a href="#cb13-12"></a><span class="co">#&gt;  24.6  22.8   5.4</span></span>
<span id="cb13-13"><a href="#cb13-13"></a><span class="kw">round</span>(<span class="kw">multi.fun</span>(straight<span class="op">$</span>x1), <span class="dv">3</span>)</span>
<span id="cb13-14"><a href="#cb13-14"></a><span class="co">#&gt;  mean media    sd </span></span>
<span id="cb13-15"><a href="#cb13-15"></a><span class="co">#&gt; 2.611 2.622 0.715</span></span></code></pre></div>
<p>We fit a linear model to the data set using the function <code>lm()</code> and check to see that both predictor variables are statistically significant.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="kw">summary</span>(<span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x1 <span class="op">+</span><span class="st"> </span><span class="kw">factor</span>(x2), <span class="dt">data=</span>set3))</span>
<span id="cb14-2"><a href="#cb14-2"></a><span class="co">#&gt; </span></span>
<span id="cb14-3"><a href="#cb14-3"></a><span class="co">#&gt; Call:</span></span>
<span id="cb14-4"><a href="#cb14-4"></a><span class="co">#&gt; lm(formula = y ~ x1 + factor(x2), data = set3)</span></span>
<span id="cb14-5"><a href="#cb14-5"></a><span class="co">#&gt; </span></span>
<span id="cb14-6"><a href="#cb14-6"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb14-7"><a href="#cb14-7"></a><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span id="cb14-8"><a href="#cb14-8"></a><span class="co">#&gt; -3.7071 -2.4415 -0.3129  1.4319  6.0156 </span></span>
<span id="cb14-9"><a href="#cb14-9"></a><span class="co">#&gt; </span></span>
<span id="cb14-10"><a href="#cb14-10"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb14-11"><a href="#cb14-11"></a><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb14-12"><a href="#cb14-12"></a><span class="co">#&gt; (Intercept)  33.0042     2.3554  14.012 1.92e-14 ***</span></span>
<span id="cb14-13"><a href="#cb14-13"></a><span class="co">#&gt; x1           -4.4428     0.6134  -7.243 5.63e-08 ***</span></span>
<span id="cb14-14"><a href="#cb14-14"></a><span class="co">#&gt; factor(x2)1   3.1544     1.1907   2.649   0.0129 *  </span></span>
<span id="cb14-15"><a href="#cb14-15"></a><span class="co">#&gt; ---</span></span>
<span id="cb14-16"><a href="#cb14-16"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb14-17"><a href="#cb14-17"></a><span class="co">#&gt; </span></span>
<span id="cb14-18"><a href="#cb14-18"></a><span class="co">#&gt; Residual standard error: 2.78 on 29 degrees of freedom</span></span>
<span id="cb14-19"><a href="#cb14-19"></a><span class="co">#&gt; Multiple R-squared:  0.801,  Adjusted R-squared:  0.7873 </span></span>
<span id="cb14-20"><a href="#cb14-20"></a><span class="co">#&gt; F-statistic: 58.36 on 2 and 29 DF,  p-value: 6.818e-11</span></span></code></pre></div>
<p>We set the function arguments of <code>genset()</code> to generate a new data set (<code>set4</code>) that will make the second predictor variable <code>vs</code>, no longer statistically significant using method <code>2</code>. We will use the function <code>set.seed()</code> so that the data set can be reproduced. Note that <code>factor(x2)</code> must be used in the formula argument when the variable is categorical.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="kw">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb15-2"><a href="#cb15-2"></a>set4 &lt;-<span class="st"> </span><span class="kw">genset</span>(y, x1, <span class="kw">factor</span>(x2), <span class="dt">method=</span><span class="dv">2</span>, <span class="dt">option=</span><span class="st">&quot;x2&quot;</span>)</span></code></pre></div>
<p>Check that the summary statisticis for the marginal distributions of Set 4 are the same as Set 3 above.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>v.shape &lt;-<span class="st"> </span><span class="kw">subset</span>(set4, x2<span class="op">==</span><span class="dv">0</span>)</span>
<span id="cb16-2"><a href="#cb16-2"></a>straight &lt;-<span class="st"> </span><span class="kw">subset</span>(set4, x2<span class="op">==</span><span class="dv">1</span>) </span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a>multi.fun &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</span>
<span id="cb17-2"><a href="#cb17-2"></a>  <span class="kw">c</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(x), <span class="dt">media=</span><span class="kw">median</span>(x), <span class="dt">sd=</span><span class="kw">sd</span>(x))</span>
<span id="cb17-3"><a href="#cb17-3"></a>}</span>
<span id="cb17-4"><a href="#cb17-4"></a><span class="kw">round</span>(<span class="kw">multi.fun</span>(v.shape<span class="op">$</span>y), <span class="dv">1</span>)</span>
<span id="cb17-5"><a href="#cb17-5"></a><span class="co">#&gt;  mean media    sd </span></span>
<span id="cb17-6"><a href="#cb17-6"></a><span class="co">#&gt;  16.7  15.7   4.3</span></span>
<span id="cb17-7"><a href="#cb17-7"></a><span class="kw">round</span>(<span class="kw">multi.fun</span>(v.shape<span class="op">$</span>x1), <span class="dv">3</span>)</span>
<span id="cb17-8"><a href="#cb17-8"></a><span class="co">#&gt;  mean media    sd </span></span>
<span id="cb17-9"><a href="#cb17-9"></a><span class="co">#&gt; 3.757 3.570 0.842</span></span>
<span id="cb17-10"><a href="#cb17-10"></a><span class="kw">round</span>(<span class="kw">multi.fun</span>(straight<span class="op">$</span>y), <span class="dv">1</span>)</span>
<span id="cb17-11"><a href="#cb17-11"></a><span class="co">#&gt;  mean media    sd </span></span>
<span id="cb17-12"><a href="#cb17-12"></a><span class="co">#&gt;  24.8  22.8   5.8</span></span>
<span id="cb17-13"><a href="#cb17-13"></a><span class="kw">round</span>(<span class="kw">multi.fun</span>(straight<span class="op">$</span>x1), <span class="dv">3</span>)</span>
<span id="cb17-14"><a href="#cb17-14"></a><span class="co">#&gt;  mean media    sd </span></span>
<span id="cb17-15"><a href="#cb17-15"></a><span class="co">#&gt; 2.577 2.622 0.653</span></span></code></pre></div>
<p>Fit a linear model to Set 4 and check to see that the second predictor variable <code>vs</code> is no longer statistically significant.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="kw">summary</span>(<span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x1 <span class="op">+</span><span class="st"> </span><span class="kw">factor</span>(x2), <span class="dt">data=</span>set4))</span>
<span id="cb18-2"><a href="#cb18-2"></a><span class="co">#&gt; </span></span>
<span id="cb18-3"><a href="#cb18-3"></a><span class="co">#&gt; Call:</span></span>
<span id="cb18-4"><a href="#cb18-4"></a><span class="co">#&gt; lm(formula = y ~ x1 + factor(x2), data = set4)</span></span>
<span id="cb18-5"><a href="#cb18-5"></a><span class="co">#&gt; </span></span>
<span id="cb18-6"><a href="#cb18-6"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb18-7"><a href="#cb18-7"></a><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span id="cb18-8"><a href="#cb18-8"></a><span class="co">#&gt; -4.5841 -2.0828 -0.1872  1.5084  8.3522 </span></span>
<span id="cb18-9"><a href="#cb18-9"></a><span class="co">#&gt; </span></span>
<span id="cb18-10"><a href="#cb18-10"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb18-11"><a href="#cb18-11"></a><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb18-12"><a href="#cb18-12"></a><span class="co">#&gt; (Intercept)  35.2778     3.0511  11.562 2.22e-12 ***</span></span>
<span id="cb18-13"><a href="#cb18-13"></a><span class="co">#&gt; x1           -4.9520     0.7854  -6.305 6.92e-07 ***</span></span>
<span id="cb18-14"><a href="#cb18-14"></a><span class="co">#&gt; factor(x2)1   2.2566     1.4950   1.509    0.142    </span></span>
<span id="cb18-15"><a href="#cb18-15"></a><span class="co">#&gt; ---</span></span>
<span id="cb18-16"><a href="#cb18-16"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb18-17"><a href="#cb18-17"></a><span class="co">#&gt; </span></span>
<span id="cb18-18"><a href="#cb18-18"></a><span class="co">#&gt; Residual standard error: 3.292 on 29 degrees of freedom</span></span>
<span id="cb18-19"><a href="#cb18-19"></a><span class="co">#&gt; Multiple R-squared:  0.7509, Adjusted R-squared:  0.7337 </span></span>
<span id="cb18-20"><a href="#cb18-20"></a><span class="co">#&gt; F-statistic: 43.71 on 2 and 29 DF,  p-value: 1.769e-09</span></span></code></pre></div>
</div>
<div id="references" class="section level2">
<h2>References</h2>
<p>Murray, L. and Wilson, J. (2020). The Need for Regression: Generating Multiple Data Sets with Identical Summary Statistics but Differing Conclusions. <em>Decision Sciences Journal of Innovative Education.</em> Accepted for publication.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
